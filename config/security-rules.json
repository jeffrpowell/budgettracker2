{
  "rules": {
    ".read": false,
    ".write": false,
    "account_category": {
      ".read": "auth.id !== null",
      ".write": "auth.id !== null",
      "$account_category_id": {
        ".validate": "newData.hasChildren()",
        "name": {".validate": "newData.isString() && newData.val().length > 0"},
        "accounts": {
          "$account_id": {".validate": "newData.isString()"}
        },
        "type": {".validate": "newData.val() == 'expense' || newData.val() == 'income' || newData.val() == 'bank'"},
        "$other": { ".validate": false }
      }
    },
    "account": {
      ".read": "auth.id !== null",
      ".write": "auth.id !== null",
      "$account_id": {
		".validate": "newData.hasChildren(['name', 'balance', 'category', 'category_type', 'goal_account'])",
        "category": {".validate": "root.child('account_category/'+newData.val()).exists()"},
		"category_type": {".validate": "newData.val() == 'expense' || newData.val() == 'income' || newData.val() == 'bank'"},
		"name": {".validate": "newData.isString() && newData.val().length > 0"},
        "balance": {".validate": "newData.isNumber()"},
        "goal": {".validate": "newData.isNumber()"},
        "goal_account": {".validate": "newData.isBoolean()"},
        "parent_account": {".validate": "root.child('account/'+newData.val()).exists()"},
        "$other": { ".validate": false }
      }
    },
    "transaction": {
      ".read": "auth.id !== null",
      ".write": "auth.id !== null",
      "$transaction_id": {
        ".validate": "newData.hasChildren(['date', 'to_account', 'from_account', 'amount', 'projection', 'memo'])",
        // dates in the format YYYY-MM-DD between the years 1900-2099
        "date": {".validate": "newData.isString() && newData.val().matches(/^(19|20)[0-9][0-9][-\\/. ](0[1-9]|1[012])[-\\/. ](0[1-9]|[12][0-9]|3[01])$/)"},
        "to_account": {".validate": "root.child('account/'+newData.val()).exists()"},
        "from_account": {".validate": "root.child('account/'+newData.val()).exists()"},
        "amount": {".validate": "newData.isNumber()"},
        "projection": {".validate": "newData.isBoolean()"},
        "memo": {".validate": "newData.isString()"},
        "$other": { ".validate": false }
      }
    }
  }
}